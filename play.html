<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE VAULT | VIP Theater</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/style.css">
    <style>
        body { background: #000; color: #fff; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* The Cinematic Theater Stage */
        #theater-stage {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: radial-gradient(circle, #111 0%, #000 100%);
        }

        .player-box {
            width: 100%;
            max-width: 1200px;
            aspect-ratio: 16/9;
            background: #050505;
            border: 1px solid #222;
            border-radius: 8px;
            box-shadow: 0 0 80px rgba(212, 175, 55, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        /* Loading & Verification UI */
        .verification-overlay {
            text-align: center;
            z-index: 10;
        }

        .pulse-ring {
            width: 60px; height: 60px;
            border: 2px solid var(--gold);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        .video-info-footer {
            background: #080808;
            padding: 20px 5%;
            border-top: 1px solid #1a1a1a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-back {
            color: var(--gold);
            text-decoration: none;
            font-size: 0.8rem;
            text-transform: uppercase;
            font-weight: bold;
            border: 1px solid var(--gold);
            padding: 8px 15px;
            border-radius: 4px;
            transition: 0.3s;
        }

        .btn-back:hover { background: var(--gold); color: #000; }
    </style>
</head>
<body>

    <header style="padding: 15px 5%; border-bottom: 1px solid #111;">
        <span style="color:var(--gold); font-weight:900; letter-spacing:3px;">THE VAULT</span>
    </header>

    <main id="theater-stage">
        <div class="player-box" id="player-mount">
            <div class="verification-overlay" id="loading-state">
                <div class="pulse-ring"></div>
                <h2 id="status-msg">VERIFYING DIGITAL RECEIPT...</h2>
                <p style="color: #444; font-size: 0.8rem;">SECURE ENCRYPTED HANDSHAKE IN PROGRESS</p>
            </div>
        </div>
    </main>

    <div class="video-info-footer">
        <div>
            <h1 id="video-title" style="margin:0; font-size:1.2rem; letter-spacing:1px;">Establishing Stream...</h1>
            <p style="margin:5px 0 0; color:#555; font-size:0.8rem;">Format: 4K ULTRA HD â€¢ Ad-Free VIP Access</p>
        </div>
        <a href="gallery.html" class="btn-back">Browse More</a>
    </div>

    <script>
        async function unlockVideo() {
            const urlParams = new URLSearchParams(window.location.search);
            const vid = urlParams.get('vid'); // The video ID
            const tid = urlParams.get('tid'); // The Payment Token (Transaction ID)

            const mount = document.getElementById('player-mount');
            const statusMsg = document.getElementById('status-msg');
            const titleEl = document.getElementById('video-title');

            // 1. Hard Check: If no transaction ID, they didn't pay
            if (!tid || tid === "DEMO") {
                statusMsg.style.color = "red";
                statusMsg.innerText = "ACCESS DENIED: NO PAYMENT FOUND";
                return;
            }

            try {
                // 2. Fetch the catalog to find the hidden XNXX ID
                const response = await fetch('database/catalog.json');
                const catalog = await response.json();
                const video = catalog.find(v => v.id === vid);

                if (video) {
                    titleEl.innerText = video.title;
                    
                    // 3. Small delay to make the "Verification" feel real
                    setTimeout(() => {
                        mount.innerHTML = `
                            <iframe 
                                src="https://www.xnxx.com/embedframe/${video.xnxx_id}" 
                                width="100%" 
                                height="100%" 
                                frameborder="0" 
                                allowfullscreen="true" 
                                scrolling="no"
                                style="background:#000;">
                            </iframe>`;
                    }, 2000);
                } else {
                    statusMsg.innerText = "ERROR: VIDEO NOT FOUND";
                }
            } catch (err) {
                statusMsg.innerText = "SYSTEM ERROR: PLEASE REFRESH";
            }
        }

        document.addEventListener('DOMContentLoaded', unlockVideo);
    </script>
</body>
</html>
